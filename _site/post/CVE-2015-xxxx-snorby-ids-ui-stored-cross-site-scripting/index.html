<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<title>CVE-2015-xxxx – Snorby – 2.6.2 - Stored Cross-site Scripting</title>
	<meta name="description" content="">
	<meta name="author" content="Federico Fazzi">
	<link rel="stylesheet" href="/assets/app-336080b4edd59c54ce59e0bce0ad17c5.css">
	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"/>
	<link rel="alternate" type="application/rss+xml" title="" href="/feed.xml">
	<link rel="canonical" href="http://deftcode.ninja/post/CVE-2015-xxxx-snorby-ids-ui-stored-cross-site-scripting/">

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-55598198-1', 'auto');
		ga('send', 'pageview');
	</script>
</head>

<body>
	<button id="toggle" class="standard-width" type="button" data-toggle="collapse">
		<span class="toggle-line"></span>
		<span class="toggle-line"></span>
		<span class="toggle-line"></span>
	</button>
	<div class="wrapper">
		<header>
	<h1>DEFTCODE<sup>( 2 )</sup></h1>

	<ul id="navbar">
		<li><a href="http://deftcode.ninja" title="Posts">Posts</a></li>
		<li><a href="http://deftcode.ninja/security" title="Security">Security</a></li>
		<li><a href="http://deftcode.ninja/about" title="About">About</a></li>
	</ul>

	<ul id="social" class="apicos-social-sport">
		
		<li><a href="https://github.com/eurialo" title="Github" target="_blank"><span class="apico apico-github-square"></span></a></li>
		
		
		<li><a href="https://linkedin.com/in/eurialo" title="Linkedin" target="_blank"><span class="apico apico-linkedin-square"></span></a></li>
		
		
		<li><a href="https://twitter.com/federicofazzi" title="Twitter" target="_blank"><span class="apico apico-twitter-square"></span></a></li>
		
		
		<li><a href="https://plus.google.com/+FedericoFazzi" title="Google+" target="_blank"><span class="apico apico-google-plus-square"></span></a></li>
		
		<li><a href="/feed.xml" title="Feed RSS" target="_blank"><span class="apico apico-rss-square"></span></a></li>
	</ul>
	<p>
		<small><a href="https://pgp.mit.edu/pks/lookup?search=0x6D378CAF&op=index&exact=on" title="MIT PGP Public Key Server - 0x6D378CAF" target="_blank">GPG - 2048R/6D378CAF</a></small>
	</p>
</header>
		<section>
		<h1 class="post-title">CVE-2015-xxxx – Snorby – 2.6.2 - Stored Cross-site Scripting</h1>
<p class="post-meta">RELEASED IN SATURDAY 18, JULY, 2015</p>

<h3 id="vendor">Vendor</h3>

<p><a href="https://www.snorby.org/" title="Snorby">https://www.snorby.org/</a> – <strong>2.6.2</strong></p>

<blockquote>
  <p>Snorby is a new and modern Snort IDS front-end. The basic fundamental concepts behind snorby are simplicity and power. The project goal is to create a free, open source and highly competitive application for network monitoring for both private and enterprise use.</p>
</blockquote>

<h3 id="description">Description</h3>

<p>Found another Stored Cross-site Scripting (XSS) vulnerability in Snorby. The vulnerability exists in the module for adding a new search type where the user input is not correctly sanitized before being saved it on the database or for example the output is not properly filtered, before its rendering in the saved searches code, in this way the vector gets executed.</p>

<p>This not require Administrative privileges to being executed.</p>

<h3 id="vulnerability">Vulnerability</h3>

<p><strong>CVSS Score</strong>: 3.5 (<a href="https://nvd.nist.gov/cvss.cfm?calculator&amp;version=2&amp;vector=(AV:N/AC:M/Au:S/C:N/I:P/A:N)" title="CVSS v2 Vector (AV:N/AC:M/Au:S/C:N/I:P/A:N)" target="_blank">AV:N/AC:M/Au:S/C:N/I:P/A:N</a>)</p>

<p>The <code>XSS vector</code> is triggered in the <strong>snorby/app/views/saved_searches/view.html.erb</strong> page:</p>

<div class="highlight"><pre><code class="language-html" data-lang="html">$(&#39;#title-header&#39;).replaceWith(&#39;<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;edit edit-search-title&quot;</span> <span class="na">id=</span><span class="s">&quot;title-header&quot;</span><span class="nt">&gt;</span>&#39;+data.title+&#39;<span class="nt">&lt;/div&gt;&lt;span</span> <span class="na">class=</span><span class="s">&quot;sub-title&quot;</span><span class="nt">&gt;</span>(click to edit)<span class="nt">&lt;/span&gt;</span>&#39;);</code></pre></div>

<!--r34dm0r3-->

<h3 id="mitigation">Mitigation</h3>

<p>A simple <code>XSS mitigation</code> on rails could be the usage of the <strong>sanitize</strong>, for example the code below filters the xss vector by removing the onerror attribute from the image tag:</p>

<div class="highlight"><pre><code class="language-html" data-lang="html">$(&#39;#title-header&#39;).replaceWith(&#39;<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">&quot;edit edit-search-title&quot;</span> <span class="na">id=</span><span class="s">&quot;title-header&quot;</span><span class="nt">&gt;</span>&#39;+sanitize data.title+&#39;<span class="nt">&lt;/div&gt;&lt;span</span> <span class="na">class=</span><span class="s">&quot;sub-title&quot;</span><span class="nt">&gt;</span>(click to edit)<span class="nt">&lt;/span&gt;</span>&#39;);</code></pre></div>

<h3 id="solution">Solution</h3>

<p><strong>Update</strong> to the <strong>latest</strong> version on <a href="https://github.com/Snorby/snorby" title="GitHub - Snorby" target="_blank">GitHub</a>.</p>

<h3 id="disclosure">Disclosure:</h3>

<ul>
  <li><strong>18-07-2015</strong> – Vendor notification (<a href="https://github.com/Snorby/snorby/issues/381" title="GitHub Issue-381" target="_blank">GitHub Issue-381</a>)</li>
  <li><strong>18-07-2015</strong> – CVE id requested</li>
  <li><strong>01-07-2015</strong> – Vendor acknowledge</li>
  <li><strong>01-07-2015</strong> – Vendor pushed a fix (commit-id: <a href="https://github.com/Snorby/snorby/commit/89d7cbcd3697c8a842f1a61b99e9a78f295798fb" title="GitHub commit-id: 89d7cbcd3697c8a842f1a61b99e9a78f295798fb" target="_blank">89d7cbcd3697c8a842f1a61b99e9a78f295798fb</a>)</li>
  <li><strong>22-07-2015</strong> – CVE id assigned (<a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5460" title="CVE-2015-5460" target="_blank">CVE-2015-5460</a>)</li>
  <li><strong>19-07-2015</strong> – Public disclosure</li>
</ul>

<h3 id="references">References</h3>

<ul>
  <li><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5460" title="CVE-2015-5460">http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-5460</a></li>
  <li><a href="http://seclists.org/fulldisclosure/2015/Jul/15" title="FullDisclosure">http://seclists.org/fulldisclosure/2015/Jul/15</a></li>
  <li><a href="https://github.com/Snorby/snorby/issues/381" title="GitHub Issue-381">https://github.com/Snorby/snorby/issues/381</a></li>
</ul>



<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-538ce0c960e04da4" async></script>
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_sharing_toolbox"></div>

<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = 'deftcode'; // required: replace example with your forum shortname

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

		</section>
		<footer>
	<p><small>2015 – <b><a href="http://en.wikipedia.org/wiki/MIT_License" title="Wikipedia.org - MIT License" target="_blank">MIT License</a></b></small></p>
</footer>
<script src="/assets/app-37906461198b3aa3d672db7880cb695d.js"></script>
	</div>
</body>
</html>
